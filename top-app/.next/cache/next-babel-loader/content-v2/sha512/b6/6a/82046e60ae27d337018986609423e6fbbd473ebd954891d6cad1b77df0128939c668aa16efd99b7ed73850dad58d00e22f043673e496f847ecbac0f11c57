{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Users/ccccc/Desktop/home__projects/top-app/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"C:/Users/ccccc/Desktop/home__projects/top-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"C:/Users/ccccc/Desktop/home__projects/top-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"C:/Users/ccccc/Desktop/home__projects/top-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport styles from \"./ReviewForm.module.css\";\nimport cn from \"classnames\";\nimport React, { useState } from \"react\";\nimport { Button, Input, Raiting, Textarea } from \"..\";\nimport CloseIcon from \"./close.svg\";\nimport { useForm, Controller } from \"react-hook-form\";\nimport axios from \"axios\";\nimport { API } from \"../../helpers/api\";\nexport var ReviewForm = function ReviewForm(_ref) {\n  var productId = _ref.productId,\n      isOpened = _ref.isOpened,\n      className = _ref.className,\n      props = _objectWithoutProperties(_ref, [\"productId\", \"isOpened\", \"className\"]);\n\n  var _useState = useState(false),\n      isSuccess = _useState[0],\n      setIsSuccess = _useState[1];\n\n  var _useState2 = useState(),\n      error = _useState2[0],\n      setIsError = _useState2[1];\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      control = _useForm.control,\n      handleSubmit = _useForm.handleSubmit,\n      errors = _useForm.formState.errors,\n      reset = _useForm.reset,\n      clearErrors = _useForm.clearErrors;\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData) {\n      var _yield$axios$post, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.post(API.review.createDemo, _objectSpread(_objectSpread({}, formData), {}, {\n                productId: productId\n              }));\n\n            case 3:\n              _yield$axios$post = _context.sent;\n              data = _yield$axios$post.data;\n\n              if (data.message) {\n                setIsSuccess(true);\n                reset();\n              } else {\n                setIsError(\"Что-то пошло не так\");\n              }\n\n              _context.next = 10;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 8]]);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"form\", {\n    onSubmit: handleSubmit(onSubmit),\n    children: [/*#__PURE__*/_jsxs(\"div\", _objectSpread(_objectSpread({\n      className: cn(styles.reviewForm, className)\n    }, props), {}, {\n      children: [/*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({}, register(\"name\", {\n        required: {\n          value: true,\n          message: \"Заполните имя\"\n        }\n      })), {}, {\n        placeholder: \"\\u0418\\u043C\\u044F\",\n        error: errors.name,\n        tabIndex: isOpened ? 0 : -1,\n        \"aria-invalid\": errors.name ? true : false\n      })), /*#__PURE__*/_jsx(Input, _objectSpread(_objectSpread({}, register(\"title\", {\n        required: {\n          value: true,\n          message: \"Заполните заголовок\"\n        }\n      })), {}, {\n        className: styles.title,\n        placeholder: \"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\",\n        error: errors.title,\n        tabIndex: isOpened ? 0 : -1,\n        \"aria-invalid\": errors.title ? true : false\n      })), /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.raiting,\n        children: [/*#__PURE__*/_jsx(\"span\", {\n          children: \"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430:\"\n        }), /*#__PURE__*/_jsx(Controller, {\n          control: control,\n          name: \"rating\",\n          rules: {\n            required: {\n              value: true,\n              message: \"Укажите рейтинг\"\n            }\n          },\n          render: function render(_ref3) {\n            var field = _ref3.field;\n            return /*#__PURE__*/_jsx(Raiting, {\n              raiting: field.value,\n              ref: field.ref,\n              isEditable: true,\n              setRaiting: field.onChange,\n              error: errors.rating,\n              tabIndex: isOpened ? 0 : -1\n            });\n          }\n        })]\n      }), /*#__PURE__*/_jsx(Textarea, _objectSpread(_objectSpread({}, register(\"description\", {\n        required: {\n          value: true,\n          message: \"Заполните отзыв\"\n        }\n      })), {}, {\n        className: styles.description,\n        placeholder: \"\\u0422\\u0435\\u043A\\u0441\\u0442 \\u043E\\u0442\\u0437\\u044B\\u0432\\u0430\",\n        error: errors.description,\n        tabIndex: isOpened ? 0 : -1,\n        \"aria-label\": \"\\u0442\\u0435\\u043A\\u0441\\u0442 \\u043E\\u0442\\u0437\\u044B\\u0432\\u0430\",\n        \"aria-invalid\": errors.description ? true : false\n      })), /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.submit,\n        children: [/*#__PURE__*/_jsx(Button, {\n          appearance: \"primary\",\n          tabIndex: isOpened ? 0 : -1,\n          onClick: function onClick() {\n            return clearErrors();\n          },\n          children: \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"\n        }), /*#__PURE__*/_jsx(\"span\", {\n          className: styles.info,\n          children: \"* \\u041F\\u0435\\u0440\\u0435\\u0434 \\u043F\\u0443\\u0431\\u043B\\u0438\\u043A\\u0430\\u0446\\u0438\\u0435\\u0439 \\u043E\\u0442\\u0437\\u044B\\u0432 \\u043F\\u0440\\u043E\\u0439\\u0434\\u0435\\u0442 \\u043F\\u0440\\u0435\\u0434\\u0432\\u0430\\u0440\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u0443\\u044E \\u043C\\u043E\\u0434\\u0435\\u0440\\u0430\\u0446\\u0438\\u044E \\u0438 \\u043F\\u0440\\u043E\\u0432\\u0435\\u0440\\u043A\\u0443\"\n        })]\n      })]\n    })), isSuccess && /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.success,\n      role: \"alert\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: styles.successTitle,\n        children: \"\\u0412\\u0430\\u0448 \\u043E\\u0442\\u0437\\u044B\\u0432 \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\"\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: styles.description,\n        children: \"\\u0412\\u0430\\u0448 \\u043E\\u0442\\u0437\\u044B\\u0432 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u043E\\u043F\\u0443\\u0431\\u043B\\u0438\\u043A\\u043E\\u0432\\u0430\\u043D \\u043F\\u043E\\u0441\\u043B\\u0435 \\u043F\\u0440\\u043E\\u0432\\u0435\\u0440\\u043A\\u0438\"\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: styles.close,\n        onClick: function onClick() {\n          return setIsSuccess(false);\n        },\n        \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C \\u043E\\u043F\\u043E\\u0432\\u0435\\u0449\\u0435\\u043D\\u0438\\u0435\",\n        children: /*#__PURE__*/_jsx(CloseIcon, {})\n      })]\n    }), error && /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.error,\n      role: \"alert\",\n      children: [\"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A, \\u043F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u043E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443\", /*#__PURE__*/_jsx(\"button\", {\n        className: styles.close,\n        onClick: function onClick() {\n          return setIsError(undefined);\n        },\n        \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C \\u043E\\u043F\\u043E\\u0432\\u0435\\u0449\\u0435\\u043D\\u0438\\u0435\",\n        children: /*#__PURE__*/_jsx(CloseIcon, {})\n      })]\n    })]\n  });\n};","map":null,"metadata":{},"sourceType":"module"}