{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\home__projects\\\\top-app\\\\pages\\\\[type]\\\\[alias].tsx\";\nimport React from \"react\";\nimport { withLayout } from \"../../layout/Layout\";\nimport axios from \"axios\";\nimport { firstLevelMenu } from \"../../helpers/helpers\";\nimport { TopPageComponent } from \"../../page-components\";\nimport { API } from \"../../helpers/api\";\nimport Head from \"next/head\";\nimport { Error404 } from \"../404\";\nconst firstCategory = 0;\n\nfunction TopPage({\n  firstCategory,\n  page,\n  products\n}) {\n  if (!page || !products) {\n    return /*#__PURE__*/_jsxDEV(Error404, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 10\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: page.metaTitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"description\",\n        content: page.metaDescription\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"og:title\",\n        content: page.metaTitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"og:description\",\n        content: page.metaDescription\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"og:type\",\n        content: \"article\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(TopPageComponent, {\n      firstCategory: firstCategory,\n      page: page,\n      products: products\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\nexport default withLayout(TopPage);\nexport const getStaticPaths = async () => {\n  let paths = [];\n\n  for (const m of firstLevelMenu) {\n    const {\n      data: menu\n    } = await axios.post(process.env.NEXT_PUBLIC_DOMAIN + \"/api/top-page/find\", {\n      firstCategory: m.id\n    });\n    paths = paths.concat(menu.flatMap(s => s.pages.map(p => `/${m.route}/${p.alias}`)));\n  }\n\n  return {\n    paths,\n    fallback: true\n  };\n};\nexport const getStaticProps = async ({\n  params\n}) => {\n  if (!params) {\n    return {\n      notFound: true\n    };\n  }\n\n  const firstCategoryItem = firstLevelMenu.find(m => m.route == params.type);\n\n  if (!firstCategoryItem) {\n    return {\n      notFound: true\n    };\n  }\n\n  try {\n    const {\n      data: menu\n    } = await axios.post(API.topPage.find, {\n      firstCategory: firstCategoryItem.id\n    });\n\n    if (menu.length == 0) {\n      return {\n        notFound: true\n      };\n    }\n\n    const {\n      data: page\n    } = await axios.get(API.topPage.byAlias + params.alias);\n    const {\n      data: products\n    } = await axios.post(API.product.find, {\n      category: page.category,\n      limit: 10\n    });\n    return {\n      props: {\n        menu,\n        firstCategory: firstCategoryItem.id,\n        page,\n        products\n      }\n    };\n  } catch (error) {\n    return {\n      notFound: true\n    };\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Desktop/home__projects/top-app/pages/[type]/[alias].tsx"],"names":["React","withLayout","axios","firstLevelMenu","TopPageComponent","API","Head","Error404","firstCategory","TopPage","page","products","metaTitle","metaDescription","getStaticPaths","paths","m","data","menu","post","process","env","NEXT_PUBLIC_DOMAIN","id","concat","flatMap","s","pages","map","p","route","alias","fallback","getStaticProps","params","notFound","firstCategoryItem","find","type","topPage","length","get","byAlias","product","category","limit","props","error"],"mappings":"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","sourcesContent":["import { GetStaticPaths, GetStaticProps, GetStaticPropsContext } from \"next\";\r\nimport React from \"react\";\r\nimport { withLayout } from \"../../layout/Layout\";\r\nimport axios from \"axios\";\r\nimport { MenuItem } from \"../../interfaces/menu.inteface\";\r\nimport { TopLevelCategory, TopPageModel } from \"../../interfaces/toppage.interface\";\r\nimport { ParsedUrlQuery } from \"querystring\";\r\nimport { ProductModel } from \"../../interfaces/product.interface\";\r\nimport { firstLevelMenu } from \"../../helpers/helpers\";\r\nimport { TopPageComponent } from \"../../page-components\";\r\nimport { API } from \"../../helpers/api\";\r\nimport Head from \"next/head\";\r\nimport { Error404 } from \"../404\";\r\n\r\nconst firstCategory = 0;\r\n\r\nfunction TopPage({ firstCategory, page, products }: PageProps): JSX.Element {\r\n\tif (!page || !products) {\r\n\t\treturn <Error404></Error404>\r\n\t}\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Head>\r\n\t\t\t\t<title>{page.metaTitle}</title>\r\n\t\t\t\t<meta name=\"description\" content={page.metaDescription}></meta>\r\n\t\t\t\t<meta property=\"og:title\" content={page.metaTitle}></meta>\r\n\t\t\t\t<meta property=\"og:description\" content={page.metaDescription}></meta>\r\n\t\t\t\t<meta property=\"og:type\" content=\"article\"></meta>\r\n\t\t\t</Head>\r\n\t\t\t<TopPageComponent\r\n\t\t\t\tfirstCategory={firstCategory}\r\n\t\t\t\tpage={page}\r\n\t\t\t\tproducts={products}\r\n\t\t\t></TopPageComponent>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default withLayout(TopPage);\r\n\r\nexport const getStaticPaths: GetStaticPaths = async () => {\r\n\tlet paths: string[] = [];\r\n\r\n\tfor (const m of firstLevelMenu) {\r\n\t\tconst { data: menu } = await axios.post<MenuItem[]>(\r\n\t\t\tprocess.env.NEXT_PUBLIC_DOMAIN + \"/api/top-page/find\",\r\n\t\t\t{\r\n\t\t\t\tfirstCategory: m.id,\r\n\t\t\t},\r\n\t\t);\r\n\t\tpaths = paths.concat(menu.flatMap((s) => s.pages.map((p) => `/${m.route}/${p.alias}`)));\r\n\t}\r\n\treturn {\r\n\t\tpaths,\r\n\t\tfallback: true,\r\n\t};\r\n};\r\n\r\nexport const getStaticProps: GetStaticProps<PageProps> = async ({\r\n\tparams,\r\n}: GetStaticPropsContext<ParsedUrlQuery>) => {\r\n\tif (!params) {\r\n\t\treturn {\r\n\t\t\tnotFound: true,\r\n\t\t};\r\n\t}\r\n\r\n\tconst firstCategoryItem = firstLevelMenu.find((m) => m.route == params.type);\r\n\tif (!firstCategoryItem) {\r\n\t\treturn {\r\n\t\t\tnotFound: true,\r\n\t\t};\r\n\t}\r\n\r\n\ttry {\r\n\t\tconst { data: menu } = await axios.post<MenuItem[]>(API.topPage.find, {\r\n\t\t\tfirstCategory: firstCategoryItem.id,\r\n\t\t});\r\n\r\n\t\tif (menu.length == 0) {\r\n\t\t\treturn {\r\n\t\t\t\tnotFound: true,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst { data: page } = await axios.get<TopPageModel>(API.topPage.byAlias + params.alias);\r\n\t\tconst { data: products } = await axios.post<ProductModel[]>(API.product.find, {\r\n\t\t\tcategory: page.category,\r\n\t\t\tlimit: 10,\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\tprops: {\r\n\t\t\t\tmenu,\r\n\t\t\t\tfirstCategory: firstCategoryItem.id,\r\n\t\t\t\tpage,\r\n\t\t\t\tproducts,\r\n\t\t\t},\r\n\t\t};\r\n\t} catch (error) {\r\n\t\treturn {\r\n\t\t\tnotFound: true,\r\n\t\t};\r\n\t}\r\n};\r\n\r\ninterface PageProps extends Record<string, unknown> {\r\n\tmenu: MenuItem[];\r\n\tfirstCategory: TopLevelCategory;\r\n\tpage: TopPageModel;\r\n\tproducts: ProductModel[];\r\n}\r\n"]},"metadata":{},"sourceType":"module"}