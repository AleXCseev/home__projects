{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/konstantinalekseev/Desktop/home__projects/top-app/components/Raiting/Raiting.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport styles from \"./Raiting.module.css\";\nimport cn from \"classnames\";\nimport { useEffect, useState, forwardRef, useRef } from \"react\";\nimport StarIcon from \"./star.svg\";\nexport const Raiting = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    isEditable = false,\n    raiting,\n    setRaiting,\n    error\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"isEditable\", \"raiting\", \"setRaiting\", \"error\"]);\n\n  const {\n    0: raitingArray,\n    1: setRaitingArray\n  } = useState(new Array(5).fill( /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)));\n  const raitingArrayRef = useRef([]);\n  useEffect(() => {\n    constructRaiting(raiting);\n  }, [raiting]);\n\n  const computeFocus = (r, i) => {\n    if (!isEditable) {\n      return -1;\n    }\n\n    if (!raiting && i == 0) {\n      return 0;\n    }\n\n    if (r == i + 1) {\n      return 0;\n    }\n\n    return -1;\n  };\n\n  const constructRaiting = currentRaiting => {\n    const updatedArray = raitingArray.map((el, index) => {\n      return /*#__PURE__*/_jsxDEV(\"span\", {\n        className: cn(styles.star, {\n          [styles.filled]: index < currentRaiting,\n          [styles.editable]: isEditable\n        }),\n        onMouseEnter: () => changeDisplay(index + 1),\n        onMouseLeave: () => changeDisplay(raiting),\n        onClick: () => onClick(index + 1),\n        tabIndex: computeFocus(raiting, index),\n        onKeyDown: handelKey,\n        ref: r => {\n          var _raitingArrayRef$curr;\n\n          return (_raitingArrayRef$curr = raitingArrayRef.current) === null || _raitingArrayRef$curr === void 0 ? void 0 : _raitingArrayRef$curr.push(r);\n        },\n        children: /*#__PURE__*/_jsxDEV(StarIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 6\n      }, this);\n    });\n    setRaitingArray(updatedArray);\n  };\n\n  const changeDisplay = index => {\n    if (!isEditable) {\n      return;\n    }\n\n    constructRaiting(index);\n  };\n\n  const onClick = index => {\n    if (!isEditable || !setRaiting) {\n      return;\n    }\n\n    setRaiting(index);\n  };\n\n  const handelKey = e => {\n    if (!isEditable || !setRaiting) {\n      return;\n    }\n\n    if (e.code == \"ArrowRight\" || e.code == \"ArrowUp\") {\n      if (!raiting) {\n        setRaiting(1);\n      } else {\n        e.preventDefault();\n        setRaiting(raiting < 5 ? raiting + 1 : 5);\n      }\n\n      raitingArrayRef.current;\n    }\n\n    if (e.code == \"ArrowLeft\" || e.code == \"ArrowDown\") {\n      if (!raiting) {\n        setRaiting(1);\n      } else {\n        e.preventDefault();\n        setRaiting(raiting > 1 ? raiting - 1 : 1);\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    className: cn(styles.raitingWrapper, {\n      [styles.error]: error\n    }),\n    children: [raitingArray.map((el, index) => {\n      return /*#__PURE__*/_jsxDEV(\"span\", {\n        children: el\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }, this);\n    }), error && /*#__PURE__*/_jsxDEV(\"span\", {\n      className: styles.errorMessage,\n      children: error.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 15\n    }, this)]\n  }), void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 4\n  }, this);\n});","map":{"version":3,"sources":["/Users/konstantinalekseev/Desktop/home__projects/top-app/components/Raiting/Raiting.tsx"],"names":["styles","cn","useEffect","useState","forwardRef","useRef","StarIcon","Raiting","ref","isEditable","raiting","setRaiting","error","props","raitingArray","setRaitingArray","Array","fill","raitingArrayRef","constructRaiting","computeFocus","r","i","currentRaiting","updatedArray","map","el","index","star","filled","editable","changeDisplay","onClick","handelKey","current","push","e","code","preventDefault","raitingWrapper","errorMessage","message"],"mappings":"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","sourcesContent":["import { RaitingProps } from \"./Raiting.props\";\nimport styles from \"./Raiting.module.css\";\nimport cn from \"classnames\";\nimport { useEffect, useState, KeyboardEvent, forwardRef, ForwardedRef, useRef } from \"react\";\nimport StarIcon from \"./star.svg\";\n\nexport const Raiting = forwardRef(\n\t(\n\t\t{ isEditable = false, raiting, setRaiting, error, ...props }: RaitingProps,\n\t\tref: ForwardedRef<HTMLDivElement>,\n\t): JSX.Element => {\n\t\tconst [raitingArray, setRaitingArray] = useState<JSX.Element[]>(new Array(5).fill(<></>));\n\t\tconst raitingArrayRef = useRef<(HTMLSpanElement | null)[]>([]);\n\n\t\tuseEffect(() => {\n\t\t\tconstructRaiting(raiting);\n\t\t}, [raiting]);\n\n\t\tconst computeFocus = (r: number, i: number): number => {\n\t\t\tif (!isEditable) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (!raiting && i == 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (r == i + 1) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn -1;\n\t\t};\n\n\t\tconst constructRaiting = (currentRaiting: number) => {\n\t\t\tconst updatedArray = raitingArray.map((el: JSX.Element, index: number) => {\n\t\t\t\treturn (\n\t\t\t\t\t<span\n\t\t\t\t\t\tclassName={cn(styles.star, {\n\t\t\t\t\t\t\t[styles.filled]: index < currentRaiting,\n\t\t\t\t\t\t\t[styles.editable]: isEditable,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tonMouseEnter={() => changeDisplay(index + 1)}\n\t\t\t\t\t\tonMouseLeave={() => changeDisplay(raiting)}\n\t\t\t\t\t\tonClick={() => onClick(index + 1)}\n\t\t\t\t\t\ttabIndex={computeFocus(raiting, index)}\n\t\t\t\t\t\tonKeyDown={handelKey}\n\t\t\t\t\t\tref={(r) => raitingArrayRef.current?.push(r)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<StarIcon></StarIcon>\n\t\t\t\t\t</span>\n\t\t\t\t);\n\t\t\t});\n\t\t\tsetRaitingArray(updatedArray);\n\t\t};\n\n\t\tconst changeDisplay = (index: number) => {\n\t\t\tif (!isEditable) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconstructRaiting(index);\n\t\t};\n\n\t\tconst onClick = (index: number) => {\n\t\t\tif (!isEditable || !setRaiting) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetRaiting(index);\n\t\t};\n\n\t\tconst handelKey = (e: KeyboardEvent) => {\n\t\t\tif (!isEditable || !setRaiting) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (e.code == \"ArrowRight\" || e.code == \"ArrowUp\") {\n\t\t\t\tif (!raiting) {\n\t\t\t\t\tsetRaiting(1);\n\t\t\t\t} else {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tsetRaiting(raiting < 5 ? raiting + 1 : 5);\n\t\t\t\t}\n\t\t\t\traitingArrayRef.current\n\t\t\t}\n\t\t\tif (e.code == \"ArrowLeft\" || e.code == \"ArrowDown\") {\n\t\t\t\tif (!raiting) {\n\t\t\t\t\tsetRaiting(1);\n\t\t\t\t} else {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tsetRaiting(raiting > 1 ? raiting - 1 : 1);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\t{...props}\n\t\t\t\tref={ref}\n\t\t\t\tclassName={cn(styles.raitingWrapper, {\n\t\t\t\t\t[styles.error]: error,\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{raitingArray.map((el: JSX.Element, index: number) => {\n\t\t\t\t\treturn <span key={index}>{el}</span>;\n\t\t\t\t})}\n\t\t\t\t{error && <span className={styles.errorMessage}>{error.message}</span>}\n\t\t\t</div>\n\t\t);\n\t},\n);\n"]},"metadata":{},"sourceType":"module"}